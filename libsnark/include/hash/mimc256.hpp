#pragma once

#include "util/algebra.hpp"

template<typename FieldT>
class Mimc256
{
public:
    static constexpr size_t BLOCK_SIZE = 64;
    static constexpr size_t DIGEST_SIZE = 32;
    static constexpr size_t ROUNDS_N = 160;

    static inline const struct Init
    {
        Init() { libff::default_ec_pp::init_public_params(); }
    } init;

#if defined(CURVE_ALT_BN128) && 0
    static inline const FieldT round_c[ROUNDS_N - 1] = {
        {(0x2181479744A6ECD18806C888A86D7284500034C9FDD801E6A14DDBEB47947142_mpz).get_mpz_t()},
        {(0x2942450724CD913A16F054EED01A046A55AE02102826F9210783C1DF21660242_mpz).get_mpz_t()},
        {(0x13B777715CB08C969977E05EBD7490C219B6DE8C3B59AF865137FCC3EF684772_mpz).get_mpz_t()},
        {(0x16F62F27966A5AB5FFD4217D78456816E00497ED35368414E8F3BE00D1821622_mpz).get_mpz_t()},
        {(0x6AEF7CB4B40421250DFD755CF6AC8608F7A52A12256719F20F44259C1BF92F72_mpz).get_mpz_t()},
        {(0xDA759D592E0503649C27ABC40A61A6A14B989D34B0916B91FF20936487CF4592_mpz).get_mpz_t()},
        {(0x380C125497A93410A42CFCF4D017BBC9291B04E948A48E983478C1C9A5288C12_mpz).get_mpz_t()},
        {(0xCE10E4422304F21E5465E9903A713E292D2765C0CE8B26B197509E02CF9730E2_mpz).get_mpz_t()},
        {(0xF709FFA7FF1AFD02D3B9230C79C8C32EEDF5DE1C4E261FD61271FDACCDCE19F2_mpz).get_mpz_t()},
        {(0x539932F39F7E8898F6726A23BF2F2E7906EDF6756AC8EA7F001DF288AB1F0932_mpz).get_mpz_t()},
        {(0xD3AB093570F4EF6787F0E83EABD6CC204E742522E5C09D1256847350E90ABB02_mpz).get_mpz_t()},
        {(0x7F8E68D64110B10FA0A281961C9A30846ACF3820C732461201D3437F13AF4E62_mpz).get_mpz_t()},
        {(0x5E24940864991D42433E40AEFD7CE2137FA6EF1F3AE46F4CFE529C604763F492_mpz).get_mpz_t()},
        {(0x360796D500F4F50D7BF250B8F80AB9FB4B2ECB27A1E164A0D3535D2EB0E04792_mpz).get_mpz_t()},
        {(0x07E9410096A7137A68F37820C6112768047009277C3924C7BAF7675B0AE84942_mpz).get_mpz_t()},
        {(0x443634554F1C5A0BEC3C89762C85A05DDB6C22901A020ACD236AE0B4460EB632_mpz).get_mpz_t()},
        {(0x5E3F5FA77B2EE9020E4DF92C2C89E78159812D8BDAE60329046AAB94787A1F52_mpz).get_mpz_t()},
        {(0x035CAF938F8A23C86D439D1970F0A6CFF51977E6666D010A936FC2CA82DFCCA2_mpz).get_mpz_t()},
        {(0x446E4F5660669DAA070E908D0F5B4E4DBD4B8B46ACE78047C10C2F1D6DE50E42_mpz).get_mpz_t()},
        {(0x99F98B07C3B11328816C6071790DF3F386EBEB5FCB379C82C8107409C500F982_mpz).get_mpz_t()},
        {(0x46DD5C087920B56CC62B7D6BC52F330D87ADB7F25908AB6C3DD03C41DD852D52_mpz).get_mpz_t()},
        {(0xCD4FCFF54A4993D7E341DCB6C5A604B18D1EED05B20F26E48CAFC876F1900FC2_mpz).get_mpz_t()},
        {(0x4CC7FBF4BF3E59FECA1424536F7D20EBB5D4995367893955D10CC57E6A5CC7F2_mpz).get_mpz_t()},
        {(0x1346A717B8A237945B7636D86F0F365A6216EE843800FF5DE2ED8BCA836356A2_mpz).get_mpz_t()},
        {(0x2B93D4464077C5FD6F66E228243178C7E8E15498F2A37E97BFBEBC593B5F73D2_mpz).get_mpz_t()},
        {(0x14B4653E326D6C6A4F4FE6E818E92C49E57E1F9E1AF0128E2BC7C2CD9300C462_mpz).get_mpz_t()},
        {(0xD398B167EA956A4924DE2C004627D0E40C0172B5D0607C3C4DCA5C62570298B2_mpz).get_mpz_t()},
        {(0xDE5CB16B2F59BD67AB4E24503FE01B244E951C19FB4F45EC2FC21F7D94B30CB2_mpz).get_mpz_t()},
        {(0x0015555D99EBCB94C80D0632CD009EB59CFF5F360383192E6D1BB8D09C943552_mpz).get_mpz_t()},
        {(0x5FF09E636F61B6C3DCB3A4053037CA51BA6FA5E63EFA2D208D5A70EB157BC092_mpz).get_mpz_t()},
        {(0xD0344122883AAF7BD1528AA797761806DF65B9A5D64A0D7D0A72DCD30B7D3442_mpz).get_mpz_t()},
        {(0x63DCEC8BF2614CA89EBD45FF8E0A72113EFB8E19C7A7AA038C77FD74989F6CE2_mpz).get_mpz_t()},
        {(0xE5BDD835926031284E98A7DE33EC7DB2318E3692D4E9C3F8B492C34E1899DDD2_mpz).get_mpz_t()},
        {(0xC0C3E41B02B573D456139E53AD308D9B6D4C852E27EF1D691358B01FC15003E2_mpz).get_mpz_t()},
        {(0x6BC194552C797DCCB4C57E3C1EFBB0DCCDAB5C4C2C775EB2D320FD17DC559192_mpz).get_mpz_t()},
        {(0xED516E915C97ECA4AAC27DDB7D5B1FCE10662DE6BFB555063242F979B6F6B162_mpz).get_mpz_t()},
        {(0x8C24F6169155D340F144EC0DE03BA9CEC349DF265A67397669944836579544F2_mpz).get_mpz_t()},
        {(0xA5A78D95262CB88DB2424AFE4D64ABD5671BF56203021AAFACB06F79837D6782_mpz).get_mpz_t()},
        {(0x6DDC12844C43FF79483CC60C290F83CA1D025B478D2C49F00361E2EC3575FC12_mpz).get_mpz_t()},
        {(0x39663FC110A3FBCD73C911ABB1F9A44865E0748A097C80FE2D6C6BFE4537E632_mpz).get_mpz_t()},
        {(0x8FC70E28C2CB6158399CF2E834F1043E5D72042456DCF6ABBA6519BFBD7D4702_mpz).get_mpz_t()},
        {(0x12F566B724FA75C3BBE378A301C66E4193E5DB4B0741409C0AAD7FA7793B6562_mpz).get_mpz_t()},
        {(0x3D3ABA28AF6F3C6089FC39D77F6F1564018E980A1627233C7B32D4A973B3BAB2_mpz).get_mpz_t()},
        {(0x84543A18A7965374C109DC3F9FFA15A50A8E594AD93123FE7908203474467432_mpz).get_mpz_t()},
        {(0x63B502C12E86242BFF472BF79AB1C9F1DF1E9CA8794F865D4530523AB4238502_mpz).get_mpz_t()},
        {(0xEDCB084C4CA39E226A469CF9AB2850262BCF40522A0D54336163238DEFF02B02_mpz).get_mpz_t()},
        {(0xF03DA79F8EBE72F9C649D9F1ACC9EED7155651FD2E50C51A1A8555FFD7E6FDA2_mpz).get_mpz_t()},
        {(0xF1D74C26784A21BCA9A1AAB700908C596293DE73B5F0A3E172F49374DAB6D742_mpz).get_mpz_t()},
        {(0xFA7DF09606D0D41D2238DB88FA8D47C0D379ABEF8330FADC8CBDE1E292468DF2_mpz).get_mpz_t()},
        {(0x8B419201BAB2940BF79E5E86394566198413BA3407894E52FA60A644A4073192_mpz).get_mpz_t()},
        {(0x4FFB9ED5516249C93022803D274A35665FE55EBE052936B51FF59EBE99D86B92_mpz).get_mpz_t()},
        {(0x8F99D5A30355D6BA116722418A88B2D5F5B5C952125186934B27FF3009CDE9D2_mpz).get_mpz_t()},
        {(0x8C3D5574AF45F067B7A4F65CC1CAC9C54DA5A047585C1230C9007CA415D98D52_mpz).get_mpz_t()},
        {(0xDFD4F48D89B2AC14F7C8442C5B41B86BBAAD7FCA9494EAECDBF59A695DAB34F2_mpz).get_mpz_t()},
        {(0x7A81703A2B880FFD1842167D45F05B26993DEAD570691FB2D2E4B35420CEC172_mpz).get_mpz_t()},
        {(0x771C5EDADF7C41D7506996ADE6B40724180C182DCDED41413269644E5DF29C52_mpz).get_mpz_t()},
        {(0x2875EA28F4CD6995842E69F157668AD5C97A8D9273642E129DA497DD861645E2_mpz).get_mpz_t()},
        {(0x3B223A0619B4F9BE06708C798104D1340A417844468F78A90A810CE72FF33232_mpz).get_mpz_t()},
        {(0x624876113EE4CE2E8532A94137295E71EFF0FEAFA5086C5F0552EAACC392A872_mpz).get_mpz_t()},
        {(0xCE36C4F3EC31CF9D41F23CFDFEA87600ADFB7C8D6531D5ED6F831DB2C62126C2_mpz).get_mpz_t()},
        {(0xAE871C4B40EE460CE3344AEAEC128B1638E3522CD2082BA575641F2B51367712_mpz).get_mpz_t()},
        {(0x31033BA09FA4E2F4D0D924C59BCD076049D572ED7207E9F536AF6BC66550B332_mpz).get_mpz_t()},
        {(0x0E3844CE69DAC18E07530A03F6F4A3FA36F51CAA35F179E30B5DCB4ECFD0E842_mpz).get_mpz_t()},
        {(0xD3F78AB9C7406893414B3B219FD98531EE7A30A1DC918CE5D4039F65BCC56782_mpz).get_mpz_t()},
        {(0x1AEB5E8E30224C44EC5B2F0219D470F2BFF91E51073B54F63F0996E471EF0B52_mpz).get_mpz_t()},
        {(0xA6D2F744D32390C0EA85941E1B6DC163BA1948E36FBCBF457A7F2283D981F2F2_mpz).get_mpz_t()},
        {(0x5DCC4F2F95DC56752EDD7CD63F0CD3528C9449130C3E662BD37C978E5F668C42_mpz).get_mpz_t()},
        {(0x1E3B4F8B909B33A8B8703D712EF7087491EB0BC30EB0E14F9903C7323254EB42_mpz).get_mpz_t()},
        {(0x56D9FBEA11CC5D373F2E3933850ED812A47B1C4F9C6C69AA6CB8D2A2E07089F2_mpz).get_mpz_t()},
        {(0x8C1C6AEEFA00C7B84A700EA38BB85973751923595D0B2998D7A67D88D3463C62_mpz).get_mpz_t()},
        {(0xF1A9E3C2BA0083A50FBA2828AEF1B4EA8455C8D66BCC677515F67947EFADF9E2_mpz).get_mpz_t()},
        {(0x1398C2826F5A321A1BD35684598FCF421A46B1ED6F968D99BF1EA3A1695138C2_mpz).get_mpz_t()},
        {(0xFF825787B7EF55F519CF1D7D9C686738146AF7D9296E0B9F76E11B861A019252_mpz).get_mpz_t()},
        {(0xC80AF8D565A355DD1695D26F845BEBE2315A09060245B72DB8628FE5580E4AF2_mpz).get_mpz_t()},
        {(0x3B703BC16A1ECE05A9D769EB0CA51AFD22B4C2E4C7C6AB92AB1AC49508075032_mpz).get_mpz_t()},
        {(0xD92BBE471FCEE2C6F1CD0C426E9B8417616E550109FC5EA2F90053050E1D5BB2_mpz).get_mpz_t()},
        {(0xD03947114E6621C17B93A82BDA603AF35982AF3E6B19AC04190F199C62384942_mpz).get_mpz_t()},
        {(0x763EFED7ED5B0E536F06B219C30719AFC9A2E4EDA944B3D640E5757395AD2EF2_mpz).get_mpz_t()},
        {(0x223EE454730E57F405275C5EFF75F5314A92729AF89B44272C4C0ACC287C9EE2_mpz).get_mpz_t()},
        {(0xDA33E8AC331A1692BAFA384553DA442B82F0E1AA5C75F16A0E3D74AFDF22B3E2_mpz).get_mpz_t()},
        {(0xE3121F34C0099E3767D3061D02FDBB2FD2B3B36A9969F8F4C283E03067F3B212_mpz).get_mpz_t()},
        {(0xB004B895F9B766B3464C628E18D500DF02753477F092FCBB761253DDBEC5E4B2_mpz).get_mpz_t()},
        {(0x5C3DCEBB73A0997403FC82EA9264419A7B9FD963EDE31AA0E27EA4DC695AADC2_mpz).get_mpz_t()},
        {(0xA60303E7A8D0B7F5DC3263C3030E2743E723E1373D0CB5BF4C174B23A4808302_mpz).get_mpz_t()},
        {(0x8759D49A23655D755509914F65D0900FF6387CE4C1902BCB63A50CF4C2A8B9D2_mpz).get_mpz_t()},
        {(0xF23D092DBA688600FE1A1129C5BD09C2A966446AB0ABEB679D7A19DAC3D63D02_mpz).get_mpz_t()},
        {(0xD6BE9CFB9B507BE72D951B0A8CB71D3C0E580BF44D121DD40B7D2FD141AFFE92_mpz).get_mpz_t()},
        {(0xD155C1E45A39FCCEA25FA8C5A126868DF278CAF8C0E7973BE63B2F5037E515C2_mpz).get_mpz_t()},
        {(0x5008F52D341A6E1FC186E65931F80C3A8CB47025A94C2762ED2E9096C10C88F2_mpz).get_mpz_t()},
        {(0x4F2252BAC1606376A6431C1DCB127ABDA6AB2EFEF0A59E8EFAE1886443B9E252_mpz).get_mpz_t()},
        {(0x9DFFBCFFE23B77B30C6DA295A9CA230D0FF6240A956644A296918BEDEDF7CFB2_mpz).get_mpz_t()},
        {(0x35C02F2CB3BA6A769139CA3668817467ADB29B7292A0D66897D6A76D99930022_mpz).get_mpz_t()},
        {(0xF296222B2A84D954A003AE70092807E80E31012EAC4EBFB1ACA835FD733FB622_mpz).get_mpz_t()},
        {(0x0204ABC0C0A9C3295BE2F1CA9C1D20FF96DA1D4C6338B6F099793D268E86D4A2_mpz).get_mpz_t()},
        {(0x95E8C3B97A39636848C8A20DCE61D985CA329D3A97D6DB57D2F202CB98FFF8C2_mpz).get_mpz_t()},
        {(0x0EB35D933B568529CA171A22F9CFEADE1260055AA9F7FFC1075DF10FA65BE352_mpz).get_mpz_t()},
        {(0x0168B5EA08C47D602A75777C1DFBE379CF9E1B32ABE5922A75926A06CBF298B2_mpz).get_mpz_t()},
        {(0xC01BFB92B586EF4C255E4944DA9EF902B55779BF69F1DF4897C312344EDFBBF2_mpz).get_mpz_t()},
        {(0x0FB17A55AC865DEC76A693ECABB015BBCE45C6586242E79D19EC4250F7AE6172_mpz).get_mpz_t()},
        {(0x4954772C504A0D8FC8C9A86104F4B2810B8CCEC94B024656B0352F351AC8C472_mpz).get_mpz_t()},
        {(0x6CF87D65F59E2F035CF465F90261916354F6C82467A9558BFB18152EEC8F7872_mpz).get_mpz_t()},
        {(0x9391856652B5BA0613BE05401DCF1137BE29F9E2540372521F79B16EB01F7182_mpz).get_mpz_t()},
        {(0x366494FF6CCFB9434B943C943F87736EF75ACC07A18D086E2685CBDCA1899492_mpz).get_mpz_t()},
        {(0x639C4A680FE71FF75FDF3F2195CC093567BC007A9AB996E4B047E00B8EAC2C42_mpz).get_mpz_t()},
        {(0xEC602CAB508F6A4258077B5D3C7D68041B9B58AC1C268B35CDDBD429CA401022_mpz).get_mpz_t()},
        {(0xAEA1AF1C6270B5D9A0394552127653345A76422E56720DC6674DC5F57FBAD1A2_mpz).get_mpz_t()},
        {(0x6917EC84FF627047BB878FF1047EA260C4115F303432D0748C2302508E66A7E2_mpz).get_mpz_t()},
        {(0xC4F58FEDB91DEBB61485091233404D37F183CD32C6845A21BBF08B08B0E04582_mpz).get_mpz_t()},
        {(0x542FB4B67CFF86751975264B98E863C2D82A2473D3FDED2D3A069B0F872D8FB2_mpz).get_mpz_t()},
        {(0xC6DCE542CF15CC414B646D637AB4B97F260C18BA61B25C3AE636E5CBE2D00CE2_mpz).get_mpz_t()},
        {(0x811AE8EB26B79B1F62C7583F1118FC25C2DB7C149B40D461C2893043BEA48AE2_mpz).get_mpz_t()},
        {(0x41B28840447888853B08BA292A7FA320F11C3FFF3CFA62CEFE1244BBD58C5282_mpz).get_mpz_t()},
        {(0xB7507C4A7E1A3B5C3CF9BED2548B56E9CB14A35D12884F74AEAA0B3F3C9FF072_mpz).get_mpz_t()},
        {(0x52F996271CAEA1733136B8689B2D3D2DC01B690454503D13CC0D821C2ABBD992_mpz).get_mpz_t()},
        {(0xAAEB79E5B50F8F854441F904FCCD8E277537BEE21898FC9BBC4393C6F87BDB72_mpz).get_mpz_t()},
        {(0x254F4C3148BC5B52BEC5B1B3F71A8F8CDB5511F838AE3075EA1956C59B68BF42_mpz).get_mpz_t()},
        {(0x844925E96D46C5FE447B6192148F25EC050786F4EE3B2F7400E80784C85CA922_mpz).get_mpz_t()},
        {(0x333A68E588BF6C98246ECDB0E0DF2A114E9046F1889C70B4B753B3EF9D985A62_mpz).get_mpz_t()},
        {(0x366081DDF74E864579D1FB0E326750A80A5044E959AF168BD89D8A86D8906082_mpz).get_mpz_t()},
        {(0xE7FE11D6081E85E844AAA8C60BD0FB92CC2DF5337EA789ABB6409A0334C07E12_mpz).get_mpz_t()},
        {(0x9258D0D12FC24F4588C9265B107E7DD6307048653F9F7428D32709CA936E58D2_mpz).get_mpz_t()},
        {(0x4FF3331E55496A51C23F3704A01632C734660330BA8EF8A0935E1134FCE35332_mpz).get_mpz_t()},
        {(0xC0414AC05DA74958C21548493287892CAE12179812BF2363CB6DD0423A662142_mpz).get_mpz_t()},
        {(0x28638146179153B9D600AF386DFEB36E53041FCA417D59137BFD7610E921C382_mpz).get_mpz_t()},
        {(0xAB0CB813CB1C11225ACA8C02B86D3FAC91CE2FD952C017560FE87599FE050CB2_mpz).get_mpz_t()},
        {(0xB1496F2C97141A877276CE07367C3AC57C82F8129C63009D95EA270598203962_mpz).get_mpz_t()},
        {(0x7C5F0ED8DCD97AB6BE509716575B69A91A15145695408AB563DA6AAF64C2BF02_mpz).get_mpz_t()},
        {(0x0A0469BD7DC1F687E70C36CAB706F0FBFA0B98D7077F0E66B225F03A7A38C462_mpz).get_mpz_t()},
        {(0x52BCF32CFEE859461952A94357A6DA34C470D006CF43099CED83F0EEEAE37CF2_mpz).get_mpz_t()},
        {(0xF5496DA52E4B4AC44D2100AD322660686AA40B03685D58683D90606A50D23962_mpz).get_mpz_t()},
        {(0xA42797D28D5CED24F8AF902530167214769EE706C8D05F9B1A578B202B37E792_mpz).get_mpz_t()},
        {(0x8FE46EC1843E04E6CD81695224FB16F10D39B0A1EFF6FF3F30A0C61C00FA6462_mpz).get_mpz_t()},
        {(0x08D94983D2F807BBE7AF622B8740D42D33678522036D77FB5A4A4DD42AAB8942_mpz).get_mpz_t()},
        {(0xF5AAA303000412506EC8DD7AC26656F908DC62816DF969B7C36EEB5E7A9DEAA2_mpz).get_mpz_t()},
        {(0xF72F8CC4434DD1279E0B37678D8BCB478794DE26E6E1A49222F219C0E5B2DF82_mpz).get_mpz_t()},
        {(0x40B6B708F2F240A4A20362CD1EB882EE252FFBB6D5A31712C33C6BBE14EB36B2_mpz).get_mpz_t()},
        {(0xB5FC13FAE6C38D151DD15A9BFB949778D0782B1CC9EDE6D1CBC19B9C8FDB3C12_mpz).get_mpz_t()},
        {(0xA552548CBCDABDDC56FB258AD8EEF0C0A6BB01B5A4061F8647CF91A7A7BC1252_mpz).get_mpz_t()},
        {(0x96980CFC8DCACE7CA5ABD31CC0A3C6BD44895BE03936A248C3DFD3F7FF1C3802_mpz).get_mpz_t()},
        {(0xCD5215F99C132E1062AC4DCCE62DE2F23B36D7005AE0C22C58D167E201EFA212_mpz).get_mpz_t()},
        {(0x9B092F14FD98446D1077BB759841B51FFFF8751262E9671E99BFD3AE90968922_mpz).get_mpz_t()},
        {(0x50A89FB558E4EB00F1B351996F8D9E086B126C4CE1A342CC42376B77FAB20892_mpz).get_mpz_t()},
        {(0x969BAD16322FEEFBBEFE54F3B392BB5E3F837691F8BC0D2A4328EE020B1D8BA2_mpz).get_mpz_t()},
        {(0x01C5FE5E3BD006046618DCDAF7E3F73694A268063D3D3AEF22149CD28CE0D5F2_mpz).get_mpz_t()},
        {(0x525061EA14A12EFBD7B45305FD5248D1F310951BCECD10894987970E86C38062_mpz).get_mpz_t()},
        {(0xC64FA4937E4F2C6139A0032D37672EB902AD06948A0A94A04E60387BA340BFA2_mpz).get_mpz_t()},
        {(0x7AFD8A2393A0B8E05905031FA228DB58C47F09E7BB47EE7C8575543E10236D82_mpz).get_mpz_t()},
        {(0x0A886C5B13091D58756A098FE6CCE38453E7984C6A9FF9AAB5475D0E308F0862_mpz).get_mpz_t()},
        {(0xBB257BFAE1F40A470C301F66B6F146C43691A1589C458435B9EF2E2B539AB572_mpz).get_mpz_t()},
        {(0x81B687CB5DA1EB423F117F58D50100098C86FC8B49BDBB7593DD025C0F14D682_mpz).get_mpz_t()},
        {(0xF96ECB5CE6056C91359F432DD092AEFCDDAB5A1561B2FE6009C57A6F2B77FEC2_mpz).get_mpz_t()},
        {(0xD9A15DEEE145EAEBE98FF0DECEFB31CBDFBD3B65B5F372FA054609E04D8F1152_mpz).get_mpz_t()},
        {(0x5D9F959E8DE1F6E378821FDCD3545EDAB3BD10D376432129323191B40371CF92_mpz).get_mpz_t()},
        {(0xC02A4AC5A417E9C1CD53DC0CBFB5A1029DBE598B6D557873BA3AFF56A0396A42_mpz).get_mpz_t()},
        {(0xED6C775496B9D4AEC345A11823A3450EFB2766FAD324E054D5D72167F27BEC72_mpz).get_mpz_t()},
        {(0x5BE01270EF0AEE9653A9F3E891389BA00249E4149C4E1A75790FCB0B9E17F012_mpz).get_mpz_t()},
        {(0xB4322C759E1028C05D3C127CF5F75D1709119A83441EFAFFBB9E218E4B89F222_mpz).get_mpz_t()},
        {(0x9E7BEF31DD71DB8081F305D53E0599AD68C4551BCA0829DDEBA13055C2036BE2_mpz).get_mpz_t()},
        {(0x14123B3718243DBB298BD66F5531F2402999855214C0D6DB90E057E532AB4232_mpz).get_mpz_t()},
    };
#else
    static inline const std::array<FieldT, ROUNDS_N - 1> round_c{
        random_array<FieldT, ROUNDS_N - 1>()};
#endif

    static void cube(FieldT &x)
    {
        FieldT t{x};
        x *= t;
        x *= t;
    }

    static FieldT hash_field(const FieldT &x, const FieldT &y)
    {
        // optimize first round
        FieldT h{x};

        cube(h);

        for (size_t i = 0; i < ROUNDS_N - 1; ++i)
        {
            h += round_c[i];
            cube(h);
        }

        // We use the Davies-Meyer construction
        // optimize first round
        h += y;
        cube(h);

        for (size_t i = 0; i < ROUNDS_N - 1; ++i)
        {
            h += y;
            h += round_c[i];
            cube(h);
        }
        h += y;

        return h;
    }

    static void hash_oneblock(uint8_t *digest, const void *message)
    {
        mpz_class tmp;

        mpz_import(tmp.get_mpz_t(), DIGEST_SIZE, 1, 1, 0, 0, message);
        FieldT x{tmp.get_mpz_t()};

        mpz_import(tmp.get_mpz_t(), DIGEST_SIZE, 1, 1, 0, 0, (const char *)message + DIGEST_SIZE);
        FieldT y{tmp.get_mpz_t()};

        x = hash_field(x, y);
        x.as_bigint().to_mpz(tmp.get_mpz_t());

        memset(digest, 0, DIGEST_SIZE);
        mpz_export(digest, NULL, 1, 1, 0, 0, tmp.get_mpz_t());
    }

    static void hash_add(void *x, const void *y)
    {
        mpz_class tmp;

        mpz_import(tmp.get_mpz_t(), DIGEST_SIZE, 1, 1, 0, 0, x);
        FieldT xf{tmp.get_mpz_t()};

        mpz_import(tmp.get_mpz_t(), DIGEST_SIZE, 1, 1, 0, 0, y);
        FieldT yf{tmp.get_mpz_t()};

        xf += yf;

        xf.as_bigint().to_mpz(tmp.get_mpz_t());
        memset(x, 0, DIGEST_SIZE);
        mpz_export(x, NULL, 1, 1, 0, 0, tmp.get_mpz_t());
    }

    Mimc256() = delete;
};

// Valid realizations of a template class must be initialized before main()!
template class Mimc256<libff::Fq<libff::default_ec_pp>>;
